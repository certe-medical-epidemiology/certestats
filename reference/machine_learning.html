<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a Machine Learning (ML) Model — machine_learning • certestats</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Create a Machine Learning (ML) Model — machine_learning"><meta property="og:description" content="These functions can be used to create a machine learning model based on different 'engines' and to generalise predicting outcomes based on such models. These functions are wrappers around tidymodels packages (especially parsnip, recipes, rsample, tune, and yardstick) created by RStudio."><meta property="og:image" content="https://certe-medical-epidemiology.github.io/certestats/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">certestats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.20.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book-open"></span>

    Manual
  </a>
</li>
<li>
  <a href="https://github.com/certe-medical-epidemiology/certestats" class="external-link">
    <span class="fab fa-github"></span>

    Source Code
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/certe-medical-epidemiology" class="external-link">
    <span class="fab fa-github"></span>

    Certe Med Epi
  </a>
</li>
<li>
  <a href="https://certe.nl" class="external-link">
    <span class="fa fa-flask"></span>

    Certe Website
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a Machine Learning (ML) Model</h1>
    <small class="dont-index">Source: <a href="https://github.com/certe-medical-epidemiology/certestats/blob/main/R/machine_learning.R" class="external-link"><code>R/machine_learning.R</code></a></small>
    <div class="hidden name"><code>machine_learning.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions can be used to create a machine learning model based on different 'engines' and to generalise predicting outcomes based on such models. These functions are wrappers around <code>tidymodels</code> packages (especially <a href="https://parsnip.tidymodels.org" class="external-link"><code>parsnip</code></a>, <a href="https://recipes.tidymodels.org" class="external-link"><code>recipes</code></a>, <a href="https://rsample.tidymodels.org" class="external-link"><code>rsample</code></a>, <a href="https://tune.tidymodels.org" class="external-link"><code>tune</code></a>, and <a href="https://yardstick.tidymodels.org" class="external-link"><code>yardstick</code></a>) created by RStudio.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ml_decision_trees</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  training_fraction <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_na_fraction <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  correlation_filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  centre <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"rpart"</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classification"</span>, <span class="st">"regression"</span>, <span class="st">"unknown"</span><span class="op">)</span>,</span>
<span>  tree_depth <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ml_linear_regression</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  training_fraction <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_na_fraction <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  correlation_filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  centre <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"regression"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ml_logistic_regression</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  training_fraction <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_na_fraction <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  correlation_filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  centre <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"glm"</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"classification"</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ml_neural_network</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  training_fraction <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_na_fraction <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  correlation_filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  centre <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"nnet"</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classification"</span>, <span class="st">"regression"</span>, <span class="st">"unknown"</span><span class="op">)</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  epochs <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ml_nearest_neighbour</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  training_fraction <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_na_fraction <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  correlation_filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  centre <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"kknn"</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classification"</span>, <span class="st">"regression"</span>, <span class="st">"unknown"</span><span class="op">)</span>,</span>
<span>  neighbors <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  weight_func <span class="op">=</span> <span class="st">"triangular"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ml_random_forest</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  training_fraction <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_na_fraction <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  correlation_filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  centre <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"ranger"</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classification"</span>, <span class="st">"regression"</span>, <span class="st">"unknown"</span><span class="op">)</span>,</span>
<span>  trees <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ml_xg_boost</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  training_fraction <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_na_fraction <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  correlation_filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  centre <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"xgboost"</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classification"</span>, <span class="st">"regression"</span>, <span class="st">"unknown"</span><span class="op">)</span>,</span>
<span>  trees <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'certestats_ml'</span></span>
<span><span class="fu"><a href="confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'certestats_ml'</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span>, plot_type <span class="op">=</span> <span class="st">"roc"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'certestats_ml'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">new_data</span>, type <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">apply_model_to</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">new_data</span>,</span>
<span>  add_certainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  only_prediction <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  correct_mistakes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  impute_algorithm <span class="op">=</span> <span class="st">"mice"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_metrics</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_accuracy</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_kappa</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_recipe</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_specification</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_rows_testing</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_rows_training</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_original_data</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_roc_data</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_coefficients</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_model_variables</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_variable_weights</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tune_parameters</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, only_params_in_model <span class="op">=</span> <span class="cn">FALSE</span>, levels <span class="op">=</span> <span class="fl">5</span>, v <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'certestats_tuning'</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"marginals"</span>, <span class="st">"parameters"</span>, <span class="st">"performance"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">check_testing_predictions</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>Data set to train</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>Outcome variable, also called the <em>response variable</em> or the <em>dependent variable</em>; the variable that must be predicted. The value will be evaluated in <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> and thus supports the <code>tidyselect</code> language. In case of classification prediction, this variable will be coerced to a <a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a>.</p></dd>


<dt id="arg-predictors">predictors<a class="anchor" aria-label="anchor" href="#arg-predictors"></a></dt>
<dd><p>Explanatory variables, also called the <em>predictors</em> or the <em>independent variables</em>; the variables that are used to predict <code>outcome</code>. These variables will be transformed using <code><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double()</a></code> (<a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a>s will be transformed to <a href="https://rdrr.io/r/base/character.html" class="external-link">character</a>s first). This value defaults to <code><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything()</a></code> and supports the <code>tidyselect</code> language.</p></dd>


<dt id="arg-training-fraction">training_fraction<a class="anchor" aria-label="anchor" href="#arg-training-fraction"></a></dt>
<dd><p>Fraction of rows to be used for <em>training</em>, defaults to 75%. The rest will be used for <em>testing</em>. If given a number over 1, the number will be considered to be the required number of rows for <em>training</em>.</p></dd>


<dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>A variable in <code>data</code> (single character or name) used to conduct
stratified sampling. When not <code>NULL</code>, each resample is created within the
stratification variable. Numeric <code>strata</code> are binned into quartiles.</p></dd>


<dt id="arg-max-na-fraction">max_na_fraction<a class="anchor" aria-label="anchor" href="#arg-max-na-fraction"></a></dt>
<dd><p>Maximum fraction of <code>NA</code> values (defaults to <code>0.01</code>) of the <code>predictors</code> before they are removed from the model</p></dd>


<dt id="arg-correlation-filter">correlation_filter<a class="anchor" aria-label="anchor" href="#arg-correlation-filter"></a></dt>
<dd><p>A <a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> to indicate whether the <code>predictors</code> should be removed that have to much correlation with each other, using <code><a href="https://recipes.tidymodels.org/reference/step_corr.html" class="external-link">recipes::step_corr()</a></code></p></dd>


<dt id="arg-centre">centre<a class="anchor" aria-label="anchor" href="#arg-centre"></a></dt>
<dd><p>A <a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> to indicate whether the <code>predictors</code> should be transformed so that their mean will be <code>0</code>, using <code><a href="https://recipes.tidymodels.org/reference/step_center.html" class="external-link">recipes::step_center()</a></code></p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>A <a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> to indicate whether the <code>predictors</code> should be transformed so that their standard deviation will be <code>1</code>, using <code><a href="https://recipes.tidymodels.org/reference/step_scale.html" class="external-link">recipes::step_scale()</a></code></p></dd>


<dt id="arg-engine">engine<a class="anchor" aria-label="anchor" href="#arg-engine"></a></dt>
<dd><p><span style="R">R</span> package or function name to be used for the model, will be passed on to <code><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">parsnip::set_engine()</a></code></p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>Type of predicted value - defaults to <code>"classification"</code>, but can also be <code>"unknown"</code> or <code>"regression"</code></p></dd>


<dt id="arg-tree-depth">tree_depth<a class="anchor" aria-label="anchor" href="#arg-tree-depth"></a></dt>
<dd><p>An integer for maximum depth of the tree.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments to be passed on to the <code>parsnip</code> functions, see <em>Model Functions</em>.</p>
<p>For the <code>tune_parameters()</code> function, these must be <code>dials</code> package calls, such as <code><a href="https://dials.tidymodels.org/reference/trees.html" class="external-link">dials::trees()</a></code> (see Examples).</p>
<p>For <code><a href="https://parsnip.tidymodels.org/reference/predict.model_fit.html" class="external-link">predict()</a></code>, these must be arguments passed on to <code><a href="https://parsnip.tidymodels.org/reference/predict.model_fit.html" class="external-link">parsnip::predict.model_fit()</a></code></p></dd>


<dt id="arg-penalty">penalty<a class="anchor" aria-label="anchor" href="#arg-penalty"></a></dt>
<dd><p>A non-negative number representing the total
amount of regularization (specific engines only).</p></dd>


<dt id="arg-epochs">epochs<a class="anchor" aria-label="anchor" href="#arg-epochs"></a></dt>
<dd><p>An integer for the number of training iterations.</p></dd>


<dt id="arg-neighbors">neighbors<a class="anchor" aria-label="anchor" href="#arg-neighbors"></a></dt>
<dd><p>A single integer for the number of neighbors
to consider (often called <code>k</code>). For <span class="pkg">kknn</span>, a value of 5
is used if <code>neighbors</code> is not specified.</p></dd>


<dt id="arg-weight-func">weight_func<a class="anchor" aria-label="anchor" href="#arg-weight-func"></a></dt>
<dd><p>A <em>single</em> character for the type of kernel function used
to weight distances between samples. Valid choices are: <code>"rectangular"</code>,
<code>"triangular"</code>, <code>"epanechnikov"</code>, <code>"biweight"</code>, <code>"triweight"</code>,
<code>"cos"</code>, <code>"inv"</code>, <code>"gaussian"</code>, <code>"rank"</code>, or <code>"optimal"</code>.</p></dd>


<dt id="arg-trees">trees<a class="anchor" aria-label="anchor" href="#arg-trees"></a></dt>
<dd><p>An integer for the number of trees contained in
the ensemble.</p></dd>


<dt id="arg-object-data">object, data<a class="anchor" aria-label="anchor" href="#arg-object-data"></a></dt>
<dd><p>outcome of machine learning model</p></dd>


<dt id="arg-plot-type">plot_type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>the plot type, can be <code>"roc"</code> (default), <code>"gain"</code>, <code>"lift"</code> or <code>"pr"</code>. These functions rely on <code><a href="https://yardstick.tidymodels.org/reference/roc_curve.html" class="external-link">yardstick::roc_curve()</a></code>, <code><a href="https://yardstick.tidymodels.org/reference/gain_curve.html" class="external-link">yardstick::gain_curve()</a></code>, <code><a href="https://yardstick.tidymodels.org/reference/lift_curve.html" class="external-link">yardstick::lift_curve()</a></code> and <code><a href="https://yardstick.tidymodels.org/reference/pr_curve.html" class="external-link">yardstick::pr_curve()</a></code> to construct the curves.</p></dd>


<dt id="arg-new-data">new_data<a class="anchor" aria-label="anchor" href="#arg-new-data"></a></dt>
<dd><p>A rectangular data object, such as a data frame.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A single character value or <code>NULL</code>. Possible values
are <code>"numeric"</code>, <code>"class"</code>, <code>"prob"</code>, <code>"conf_int"</code>, <code>"pred_int"</code>,
<code>"quantile"</code>, <code>"time"</code>, <code>"hazard"</code>, <code>"survival"</code>, or <code>"raw"</code>. When <code>NULL</code>,
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> will choose an appropriate value based on the model's mode.</p></dd>


<dt id="arg-add-certainty">add_certainty<a class="anchor" aria-label="anchor" href="#arg-add-certainty"></a></dt>
<dd><p>a <a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> to indicate whether certainties should be added to the output <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></p></dd>


<dt id="arg-only-prediction">only_prediction<a class="anchor" aria-label="anchor" href="#arg-only-prediction"></a></dt>
<dd><p>a <a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> to indicate whether predictions must be returned as <a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a>, otherwise returns a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></p></dd>


<dt id="arg-correct-mistakes">correct_mistakes<a class="anchor" aria-label="anchor" href="#arg-correct-mistakes"></a></dt>
<dd><p>a <a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> to indicate whether missing variables and missing values should be added to <code>new_data</code></p></dd>


<dt id="arg-impute-algorithm">impute_algorithm<a class="anchor" aria-label="anchor" href="#arg-impute-algorithm"></a></dt>
<dd><p>the algorithm to use in <code><a href="impute.html">impute()</a></code> if <code>correct_mistakes = TRUE</code>. Can be <code>"mice"</code> (default) for the <a href="https://amices.org/mice/reference/mice.html" class="external-link">Multivariate Imputations by Chained Equations (MICE) algorithm</a>, or <code>"single-point"</code> for a trained median.</p></dd>


<dt id="arg-only-params-in-model">only_params_in_model<a class="anchor" aria-label="anchor" href="#arg-only-params-in-model"></a></dt>
<dd><p>a <a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> to indicate whether only parameters in the model should be tuned</p></dd>


<dt id="arg-levels">levels<a class="anchor" aria-label="anchor" href="#arg-levels"></a></dt>
<dd><p>An integer for the number of values of each parameter to use
to make the regular grid. <code>levels</code> can be a single integer or a vector of
integers that is the same length as the number of parameters in <code>...</code>.
<code>levels</code> can be a named integer vector, with names that match the id values
of parameters.</p></dd>


<dt id="arg-v">v<a class="anchor" aria-label="anchor" href="#arg-v"></a></dt>
<dd><p>The number of partitions of the data set.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A machine learning model of class <code>certestats_ml</code> / <code>_rpart</code> / <code>model_fit</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>To predict <strong>regression</strong> (numeric values), the function <code>ml_logistic_regression()</code> cannot be used.</p>
<p>To predict <strong>classifications</strong> (character values), the function <code>ml_linear_regression()</code> cannot be used.</p>
<p>The workflow of the <code>ml_*()</code> functions is basically like this (thus saving a lot of <code>tidymodels</code> functions to type):</p>
<div class="sourceCode"><pre><code>
                       .data
                         |
               rsample::initial_split()
                     /        \
     rsample::training() rsample::testing()
             |                |
       recipe::recipe()       |
             |                |
      recipe::step_corr()     |
             |                |
     recipe::step_center()    |
             |                |
      recipe::step_scale()    |
             |                |
        recipe::prep()        |
         /           \        |
recipes::bake()       recipes::bake()
       |                      |
generics::fit()      yardstick::metrics()
       |                      |
    output            attributes(output)
</code></pre></div>

<p>Use <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> on a model to plot the receiver operating characteristic (ROC) curve, the gain curve, the lift curve, or the precision-recall (PR) curve. For the ROC curve, the (overall) area under the curve (AUC) will be printed as subtitle.</p>
<p>The <code><a href="https://parsnip.tidymodels.org/reference/predict.model_fit.html" class="external-link">predict()</a></code> function can be used to fit a model on a new data set. Its wrapper <code>apply_model_to()</code> works in the same way, but can also detect missing variables and missing data points within variables (and can add or fill them), and detects data type differences between the trained data and the input data.</p>
<p>Use the <code>get_model_variables()</code> function to return a zero-row <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> with the variables that were used for training, even before the recipe steps.</p>
<p>Use the <code>get_variable_weights()</code> function to determine the (rough) estimated weights of each variable in the model. This is not as reliable as retrieving coefficients, but it does work for any model. The weights are determined by running the model over all the highest and lowest values of each variable in the trained data. The function returns a data set with 1 row, of which the values sum up to 1.</p>
<p>Use the <code>tune_parameters()</code> function to analyse tune parameters of any <code>ml_*()</code> function. Without any parameters manually defined, it will try to tune all parameters of the underlying ML model. The tuning will be based on a <a href="https://rsample.tidymodels.org/reference/vfold_cv.html" class="external-link">V-fold cross-validation</a>, of which the number of partitions can be set with <code>v</code>. The number of <code>levels</code> will be used to split the range of the parameters. For example, a range of 1-10 with <code>levels = 2</code> will lead to <code>[1, 10]</code>, while <code>levels = 5</code> will lead to <code>[1, 3, 5, 7, 9]</code>. The resulting <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> will be sorted from best to worst. These results can also be plotted using <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code>.</p>
<p>The <code>check_testing_predictions()</code> function combines the data used for testing from the original data with its predictions, so the original data can be reviewed per prediction.</p>
    </div>
    <div id="attributes">
    <h2>Attributes</h2>


<p>The <code>ml_*()</code> functions return the following <a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a>:</p><ul><li><p><code>properties</code>: a <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> with model properties: the ML function, engine package, training size, testing size, strata size, mode, and the different ML function-specific properties (such as <code>tree_depth</code> in <code>ml_decision_trees()</code>)</p></li>
<li><p><code>recipe</code>: a <a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a> as generated with <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">recipes::prep()</a></code>, to be used for training and testing</p></li>
<li><p><code>data_original</code>: a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> containing the original data, possibly without invalid strata</p></li>
<li><p><code>data_structure</code>: a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> containing the original data structure (only trained variables) with zero rows</p></li>
<li><p><code>data_means</code>: a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> containing the means of the original data (only trained variables)</p></li>
<li><p><code>data_training</code>: a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> containing the training data of <code>data_original</code></p></li>
<li><p><code>data_testing</code>: a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> containing the testing data of <code>data_original</code></p></li>
<li><p><code>rows_training</code>: an <a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> vector of rows used for training in <code>data_original</code></p></li>
<li><p><code>rows_testing</code>: an <a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> vector of rows used for training in <code>data_original</code></p></li>
<li><p><code>predictions</code>: a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> containing predicted values based on the testing data</p></li>
<li><p><code>metrics</code>: a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> with model metrics as returned by <code><a href="https://yardstick.tidymodels.org/reference/metrics.html" class="external-link">yardstick::metrics()</a></code></p></li>
<li><p><code>correlation_filter</code>: a <a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> indicating whether <code><a href="https://recipes.tidymodels.org/reference/step_corr.html" class="external-link">recipes::step_corr()</a></code> has been applied</p></li>
<li><p><code>centre</code>: a <a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> indicating whether <code><a href="https://recipes.tidymodels.org/reference/step_center.html" class="external-link">recipes::step_center()</a></code> has been applied</p></li>
<li><p><code>scale</code>: a <a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> indicating whether <code><a href="https://recipes.tidymodels.org/reference/step_scale.html" class="external-link">recipes::step_scale()</a></code> has been applied</p></li>
</ul></div>
    <div id="model-functions">
    <h2>Model Functions</h2>


<p>These are the called functions from the <code>parsnip</code> package. Arguments set in <code>...</code> will be passed on to these <code>parsnip</code> functions:</p><ul><li><p><code>ml_decision_trees</code>: <code><a href="https://parsnip.tidymodels.org/reference/decision_tree.html" class="external-link">parsnip::decision_tree()</a></code></p></li>
<li><p><code>ml_linear_regression</code>: <code><a href="https://parsnip.tidymodels.org/reference/linear_reg.html" class="external-link">parsnip::linear_reg()</a></code></p></li>
<li><p><code>ml_logistic_regression</code>: <code><a href="https://parsnip.tidymodels.org/reference/logistic_reg.html" class="external-link">parsnip::logistic_reg()</a></code></p></li>
<li><p><code>ml_neural_network</code>: <code><a href="https://parsnip.tidymodels.org/reference/mlp.html" class="external-link">parsnip::mlp()</a></code></p></li>
<li><p><code>ml_nearest_neighbour</code>: <code><a href="https://parsnip.tidymodels.org/reference/nearest_neighbor.html" class="external-link">parsnip::nearest_neighbor()</a></code></p></li>
<li><p><code>ml_random_forest</code>: <code><a href="https://parsnip.tidymodels.org/reference/rand_forest.html" class="external-link">parsnip::rand_forest()</a></code></p></li>
<li><p><code>ml_xg_boost</code>: <code><a href="https://parsnip.tidymodels.org/reference/xgb_train.html" class="external-link">parsnip::xgb_train()</a></code></p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># 'esbl_tests' is an included data set, see ?esbl_tests</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">esbl_tests</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 × 19</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   esbl  genus    AMC   AMP   TZP   CXM   FOX   CTX   CAZ   GEN   TOB   TMP   SXT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> FALSE Esche…    32    32     4    64    64  8     8        1     1  16      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> FALSE Esche…    32    32     4    64    64  4     8        1     1  16     320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> FALSE Esche…     4     2    64     8     4  8     0.12    16    16   0.5    20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> FALSE Klebs…    32    32    16    64    64  8     8        1     1   0.5    20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> FALSE Esche…    32    32     4     4     4  0.25  2        1     1  16     320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 495 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 6 more variables: NIT &lt;dbl&gt;, FOS &lt;dbl&gt;, CIP &lt;dbl&gt;, IPM &lt;dbl&gt;, MEM &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   COL &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict ESBL test outcome based on MICs using 2 different models</span></span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="va">esbl_tests</span> <span class="op">|&gt;</span> <span class="fu">ml_xg_boost</span><span class="op">(</span><span class="va">esbl</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="va">esbl_tests</span> <span class="op">|&gt;</span> <span class="fu">ml_random_forest</span><span class="op">(</span><span class="va">esbl</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">|&gt;</span> <span class="fu">get_metrics</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .metric .estimator .estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 accuracy     binary 0.9600000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      kap     binary 0.9199641</span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">|&gt;</span> <span class="fu">get_metrics</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .metric .estimator .estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 accuracy     binary 0.9440000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      kap     binary 0.8874598</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">|&gt;</span> <span class="fu"><a href="confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Original data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TRUE    62     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   FALSE    4    58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model metrics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Accuracy                                       0.960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Area under the Precision Recall Curve (APRC)   0.496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Area under the Receiver Operator Curve (AROC)  0.040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Balanced Accuracy                              0.960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Brier Score for Classification Models (BSCM)   1.896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Costs Function for Poor Classification (CFPC)  0.952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F Measure                                      0.961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gain Capture                                  -0.920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> J-Index                                        0.920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kappa                                          0.920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matthews Correlation Coefficient (MCC)         0.921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean log Loss for Multinomial Data (MLMD)     17.878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Negative Predictive Value (NPV)                0.983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Positive Predictive Value (PPV)                0.939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Precision                                      0.939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prevalence                                     0.528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Recall                                         0.984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivity                                    0.984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Specificity                                    0.935</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Applying A Model -----------------------------------------------------</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># simply use base R `predict()` to apply a model:</span></span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">esbl_tests</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 × 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .pred_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 490 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># but apply_model_to() contains more info and can apply corrections:</span></span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">|&gt;</span> <span class="fu">apply_model_to</span><span class="op">(</span><span class="va">esbl_tests</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    predicted certainty .pred_TRUE .pred_FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> FALSE         1.00   0.000<span style="text-decoration: underline;">053</span>8       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> FALSE         1.00   0.000<span style="text-decoration: underline;">053</span>8       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> FALSE         0.990  0.010<span style="text-decoration: underline;">1</span>          0.990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> FALSE         1.00   0.000<span style="text-decoration: underline;">026</span>4       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> FALSE         1.00   0.000<span style="text-decoration: underline;">243</span>        1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> FALSE         0.989  0.010<span style="text-decoration: underline;">7</span>          0.989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> FALSE         0.999  0.001<span style="text-decoration: underline;">23</span>         0.999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> FALSE         0.999  0.000<span style="text-decoration: underline;">556</span>        0.999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> FALSE         1.00   0.000<span style="text-decoration: underline;">028</span>2       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> FALSE         0.998  0.001<span style="text-decoration: underline;">53</span>         0.998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 490 more rows</span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">|&gt;</span> <span class="fu">apply_model_to</span><span class="op">(</span><span class="va">esbl_tests</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    predicted certainty .pred_TRUE .pred_FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> FALSE         1.00   0.000<span style="text-decoration: underline;">053</span>8       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> FALSE         1.00   0.000<span style="text-decoration: underline;">053</span>8       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> FALSE         0.906  0.093<span style="text-decoration: underline;">9</span>          0.906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> FALSE         1.00   0.000<span style="text-decoration: underline;">026</span>4       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> FALSE         1.00   0.000<span style="text-decoration: underline;">316</span>        1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> FALSE         0.989  0.010<span style="text-decoration: underline;">7</span>          0.989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> FALSE         0.998  0.001<span style="text-decoration: underline;">93</span>         0.998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> FALSE         0.903  0.096<span style="text-decoration: underline;">9</span>          0.903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> FALSE         1.00   0.000<span style="text-decoration: underline;">028</span>2       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> FALSE         1.00   0.000<span style="text-decoration: underline;">025</span>0       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 490 more rows</span></span>
<span class="r-in"><span><span class="va">esbl_tests2</span> <span class="op">&lt;-</span> <span class="va">esbl_tests</span></span></span>
<span class="r-in"><span><span class="va">esbl_tests2</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"CIP"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">esbl_tests2</span><span class="op">[</span><span class="fl">5</span>, <span class="st">"AMC"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="co"># with XGBoost, nothing will be changed (it can correct for missings):</span></span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">|&gt;</span> <span class="fu">apply_model_to</span><span class="op">(</span><span class="va">esbl_tests2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    predicted certainty .pred_TRUE .pred_FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> FALSE         1.00   0.000<span style="text-decoration: underline;">053</span>8       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> FALSE         1.00   0.000<span style="text-decoration: underline;">053</span>8       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> FALSE         0.990  0.010<span style="text-decoration: underline;">1</span>          0.990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> FALSE         1.00   0.000<span style="text-decoration: underline;">026</span>4       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> FALSE         0.998  0.001<span style="text-decoration: underline;">60</span>         0.998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> FALSE         0.989  0.010<span style="text-decoration: underline;">7</span>          0.989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> FALSE         0.999  0.001<span style="text-decoration: underline;">23</span>         0.999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> FALSE         0.999  0.000<span style="text-decoration: underline;">556</span>        0.999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> FALSE         1.00   0.000<span style="text-decoration: underline;">028</span>2       1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> FALSE         0.998  0.001<span style="text-decoration: underline;">53</span>         0.998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 490 more rows</span></span>
<span class="r-in"><span><span class="co"># with random forest (or others), missings will be imputed:</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">|&gt;</span> <span class="fu">apply_model_to</span><span class="op">(</span><span class="va">esbl_tests2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Generating MICE using m = 5 multiple imputations... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Imputed variable 'AMC' using MICE (method: predictive mean matching) in row 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Imputed variable 'CIP' using MICE (method: predictive mean matching) in row 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    predicted certainty .pred_TRUE .pred_FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> FALSE         0.965    0.035<span style="text-decoration: underline;">4</span>        0.965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> FALSE         0.910    0.089<span style="text-decoration: underline;">5</span>        0.910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> FALSE         0.735    0.265         0.735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> FALSE         0.991    0.009<span style="text-decoration: underline;">48</span>       0.991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> FALSE         0.919    0.081<span style="text-decoration: underline;">4</span>        0.919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> FALSE         0.747    0.253         0.747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> FALSE         0.994    0.006<span style="text-decoration: underline;">35</span>       0.994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> FALSE         0.952    0.047<span style="text-decoration: underline;">5</span>        0.952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> FALSE         0.949    0.051<span style="text-decoration: underline;">4</span>        0.949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> FALSE         0.894    0.106         0.894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 490 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Tuning A Model -------------------------------------------------------</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># tune the parameters of a model (will take some time)</span></span></span>
<span class="r-in"><span><span class="va">tuning</span> <span class="op">&lt;-</span> <span class="va">model2</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu">tune_parameters</span><span class="op">(</span>v <span class="op">=</span> <span class="fl">5</span>, levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming tuning analysis for the 3 parameters 'mtry', 'trees', 'min_n'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use e.g. `mtry = dials::mtry()` to specify tuning for less parameters.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming upper range of 16 for `dials::mtry()` because of number of available predictors.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> These parameters will be tuned with these values:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   - mtry: 1, 8, 16</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   - trees: 1, 1000, 2000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   - min_n: 2, 21, 40</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2024-09-11 08:22:09] Running tuning analysis using a 5-fold cross-validation for 27 combinations...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2024-09-11 08:22:29] Done.</span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">tuning</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="machine_learning-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># tuning analysis by specifying (some) parameters</span></span></span>
<span class="r-in"><span><span class="va">iris</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu">ml_random_forest</span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu">tune_parameters</span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu">dials</span><span class="fu">::</span><span class="fu"><a href="https://dials.tidymodels.org/reference/mtry.html" class="external-link">mtry</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  trees <span class="op">=</span> <span class="fu">dials</span><span class="fu">::</span><span class="fu"><a href="https://dials.tidymodels.org/reference/trees.html" class="external-link">trees</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> These parameters will be tuned with these values:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   - mtry: 1, 2, 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   - trees: 1, 500, 1000, 1500, 2000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2024-09-11 08:22:30] Running tuning analysis using a 10-fold cross-validation for 15 combinations...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2024-09-11 08:22:42] Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 15 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mtry trees     n .config            accuracy brier_class roc_auc accuracy_se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     2  <span style="text-decoration: underline;">1</span>000    10 Preprocessor1_Mod…    0.964      0.040<span style="text-decoration: underline;">7</span>   0.989      0.020<span style="text-decoration: underline;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     2  <span style="text-decoration: underline;">2</span>000    10 Preprocessor1_Mod…    0.964      0.040<span style="text-decoration: underline;">8</span>   0.989      0.020<span style="text-decoration: underline;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     2  <span style="text-decoration: underline;">1</span>500    10 Preprocessor1_Mod…    0.964      0.040<span style="text-decoration: underline;">9</span>   0.986      0.020<span style="text-decoration: underline;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     1  <span style="text-decoration: underline;">2</span>000    10 Preprocessor1_Mod…    0.955      0.052<span style="text-decoration: underline;">4</span>   0.986      0.020<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     1  <span style="text-decoration: underline;">1</span>500    10 Preprocessor1_Mod…    0.955      0.052<span style="text-decoration: underline;">8</span>   0.985      0.020<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     1   500    10 Preprocessor1_Mod…    0.955      0.052<span style="text-decoration: underline;">2</span>   0.982      0.020<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     3  <span style="text-decoration: underline;">1</span>500    10 Preprocessor1_Mod…    0.955      0.042<span style="text-decoration: underline;">6</span>   0.982      0.020<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     1  <span style="text-decoration: underline;">1</span>000    10 Preprocessor1_Mod…    0.955      0.052<span style="text-decoration: underline;">9</span>   0.982      0.020<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     3  <span style="text-decoration: underline;">1</span>000    10 Preprocessor1_Mod…    0.955      0.043<span style="text-decoration: underline;">1</span>   0.981      0.020<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     3  <span style="text-decoration: underline;">2</span>000    10 Preprocessor1_Mod…    0.955      0.042<span style="text-decoration: underline;">4</span>   0.981      0.020<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span>     2   500    10 Preprocessor1_Mod…    0.955      0.041<span style="text-decoration: underline;">0</span>   0.980      0.020<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span>     3   500    10 Preprocessor1_Mod…    0.946      0.043<span style="text-decoration: underline;">1</span>   0.982      0.020<span style="text-decoration: underline;">0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span>     3     1    10 Preprocessor1_Mod…    0.918      0.061<span style="text-decoration: underline;">5</span>   0.944      0.028<span style="text-decoration: underline;">6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span>     2     1    10 Preprocessor1_Mod…    0.893      0.093<span style="text-decoration: underline;">6</span>   0.928      0.022<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span>     1     1    10 Preprocessor1_Mod…    0.892      0.105    0.911      0.029<span style="text-decoration: underline;">8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: brier_class_se &lt;dbl&gt;, roc_auc_se &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Practical Example #1 --------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this is what iris data set looks like:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          5.1         3.5          1.4         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          4.9         3.0          1.4         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          4.7         3.2          1.3         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          4.6         3.1          1.5         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          5.0         3.6          1.4         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          5.4         3.9          1.7         0.4  setosa</span>
<span class="r-in"><span><span class="co"># create a model to predict the species:</span></span></span>
<span class="r-in"><span><span class="va">iris_model</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu">ml_xg_boost</span><span class="op">(</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris_model_rf</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu">ml_random_forest</span><span class="op">(</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># is it a bit reliable?</span></span></span>
<span class="r-in"><span><span class="fu">get_metrics</span><span class="op">(</span><span class="va">iris_model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .metric .estimator .estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 accuracy multiclass 0.9473684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      kap multiclass 0.9200000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now try to predict species from an arbitrary data set:</span></span></span>
<span class="r-in"><span><span class="va">to_predict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sepal.Length <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                         Sepal.Width <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                         Petal.Length <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>                         Petal.Width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">to_predict</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            5           3          1.5         0.5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># should be 'setosa' in the 'predicted' column:</span></span></span>
<span class="r-in"><span><span class="va">iris_model</span> <span class="op">|&gt;</span> <span class="fu">apply_model_to</span><span class="op">(</span><span class="va">to_predict</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   predicted certainty .pred_setosa .pred_versicolor .pred_virginica</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> setosa        0.996        0.996          0.003<span style="text-decoration: underline;">44</span>        0.000<span style="text-decoration: underline;">170</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># which variables are generally important (only trained variables)?</span></span></span>
<span class="r-in"><span><span class="va">iris_model</span> <span class="op">|&gt;</span> <span class="fu">get_variable_weights</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>        0.330       0.338            0       0.333</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># how would the model do without the important 'Sepal.Length' column?</span></span></span>
<span class="r-in"><span><span class="va">to_predict</span> <span class="op">&lt;-</span> <span class="va">to_predict</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Width"</span>, <span class="st">"Petal.Width"</span>, <span class="st">"Petal.Length"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">to_predict</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Width Petal.Width Petal.Length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           3         0.5          1.5</span>
<span class="r-in"><span><span class="va">iris_model</span> <span class="op">|&gt;</span> <span class="fu">apply_model_to</span><span class="op">(</span><span class="va">to_predict</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   predicted certainty .pred_setosa .pred_versicolor .pred_virginica</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> setosa        0.995        0.995          0.004<span style="text-decoration: underline;">73</span>        0.000<span style="text-decoration: underline;">169</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now compare that with a random forest model that requires imputation:</span></span></span>
<span class="r-in"><span><span class="va">iris_model_rf</span> <span class="op">|&gt;</span> <span class="fu">apply_model_to</span><span class="op">(</span><span class="va">to_predict</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding missing variable as median (= 5.8): Sepal.Length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   predicted certainty .pred_setosa .pred_versicolor .pred_virginica</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> setosa        0.554        0.554            0.411          0.035<span style="text-decoration: underline;">1</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Practical Example #2 -------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this example shows plotting methods for a model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># train model to predict genus based on MICs:</span></span></span>
<span class="r-in"><span><span class="va">genus</span> <span class="op">&lt;-</span> <span class="va">esbl_tests</span> <span class="op">|&gt;</span> <span class="fu">ml_neural_network</span><span class="op">(</span><span class="va">genus</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">genus</span> <span class="op">|&gt;</span> <span class="fu">get_metrics</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .metric .estimator .estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 accuracy multiclass 0.7520000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      kap multiclass 0.6303186</span>
<span class="r-in"><span><span class="va">genus</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="machine_learning-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">genus</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span>plot_type <span class="op">=</span> <span class="st">"gain"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="machine_learning-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">genus</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span>plot_type <span class="op">=</span> <span class="st">"pr"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="machine_learning-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Matthijs S. Berends, Erwin Dijkstra, Certe Medical Diagnostics &amp; Advice Foundation.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

