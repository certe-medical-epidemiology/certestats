<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Early Warning for Disease Clusters — early_warning_cluster • certestats</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Early Warning for Disease Clusters — early_warning_cluster"><meta property="og:description" content="early_warning_cluster() can detect so-called disease clusters. Use has_clusters() to return TRUE or FALSE on its output, or use format() to format the output."><meta property="og:image" content="https://certe-medical-epidemiology.github.io/certestats/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">certestats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.16.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book-open"></span>
     
    Manual
  </a>
</li>
<li>
  <a href="https://github.com/certe-medical-epidemiology/certestats" class="external-link">
    <span class="fab fa-github"></span>
     
    Source Code
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/certe-medical-epidemiology" class="external-link">
    <span class="fab fa-github"></span>
     
    Certe Med Epi
  </a>
</li>
<li>
  <a href="https://certe.nl" class="external-link">
    <span class="fa fa-flask"></span>
     
    Certe Website
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Early Warning for Disease Clusters</h1>
    <small class="dont-index">Source: <a href="https://github.com/certe-medical-epidemiology/certestats/blob/HEAD/R/early_warning.R" class="external-link"><code>R/early_warning.R</code></a></small>
    <div class="hidden name"><code>early_warning_cluster.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>early_warning_cluster()</code> can detect so-called <a href="https://en.wikipedia.org/wiki/Disease_cluster" class="external-link">disease clusters</a>. Use <code>has_clusters()</code> to return <code>TRUE</code> or <code>FALSE</code> on its output, or use <code><a href="https://rdrr.io/r/base/format.html" class="external-link">format()</a></code> to format the output.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">early_warning_cluster</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  group_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_patientid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  based_on_historic_maximum <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  minimum_ongoing_days <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  threshold_percentile <span class="op">=</span> <span class="fl">97.5</span>,</span>
<span>  remove_outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  remove_outliers_coefficient <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  moving_average_days <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  moving_average_side <span class="op">=</span> <span class="st">"centre"</span>,</span>
<span>  case_free_days <span class="op">=</span> <span class="fl">14</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">n_clusters</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">has_clusters</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">has_ongoing_cluster</span><span class="op">(</span><span class="va">x</span>, reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>df</dt>
<dd><p>data set, this must be a data set containing <strong>only positive results</strong>. The most bare-bone data set to use must have at least a date column and patient column. Do not summarise on patient IDs, this will happen automatically.</p></dd>


<dt>...</dt>
<dd><p>filter arguments to define the data to study, e.g., <code>jaar == 2023</code>. All other observations will be used as a control.</p></dd>


<dt>group_by</dt>
<dd><p>column to use in <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code>, e.g., a microorganism name</p></dd>


<dt>column_date</dt>
<dd><p>name of the column to use for dates, will take the first date column if left blank</p></dd>


<dt>column_patientid</dt>
<dd><p>name of the column to use for patient IDs, will take the first column names resembling <code>"patient|patid"</code> if left blank</p></dd>


<dt>based_on_historic_maximum</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> to indicate whether the percentile must be based on the maximum of previous years. With <code>FALSE</code> (default), the percentile will be based on all historic data points.</p></dd>


<dt>minimum_ongoing_days</dt>
<dd><p>number of days that must have passed above the set percentile before detecting the elevation as cluster</p></dd>


<dt>threshold_percentile</dt>
<dd><p>threshold to set</p></dd>


<dt>remove_outliers</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> to indicate whether outliers must be removed before threshold determination</p></dd>


<dt>remove_outliers_coefficient</dt>
<dd><p>coefficient to use for outlier determination</p></dd>


<dt>moving_average_days</dt>
<dd><p>number of days to set in <code><a href="moving_average.html">moving_average()</a></code></p></dd>


<dt>moving_average_side</dt>
<dd><p>side of days to set in <code><a href="moving_average.html">moving_average()</a></code></p></dd>


<dt>case_free_days</dt>
<dd><p>number of days to set in <code><a href="https://msberends.github.io/AMR/reference/get_episode.html" class="external-link">get_episode()</a></code></p></dd>


<dt>x</dt>
<dd><p>output of <code>early_warning_cluster()</code></p></dd>


<dt>n</dt>
<dd><p>number of clusters, defaults to 1</p></dd>


<dt>reference</dt>
<dd><p>date to test whether any of the clusters currently has this date in it</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>A (disease) cluster is defined as an unusually large aggregation of disease events in time or space (<a href="https://www.atsdr.cdc.gov/hec/csem/cluster/docs/clusters.pdf" class="external-link">ATSDR, 2008</a>). They are common, particularly in large populations. From a statistical standpoint, it is nearly inevitable that some clusters of chronic diseases will emerge within various communities, be it schools, church groups, social circles, or neighborhoods. Initially, these clusters are often perceived as products of specific, predictable processes rather than random occurrences in a particular location, akin to a coin toss.</p>
<p>Whether a (suspected) cluster corresponds to an actual increase of disease in the area, needs to be assessed by an epidemiologists or biostatistician (<a href="https://www.atsdr.cdc.gov/hec/csem/cluster/docs/clusters.pdf" class="external-link">ATSDR, 2008</a>).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2015-01-01"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                      <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2022-12-31"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                      <span class="st">"1 day"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  size <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    patient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">LETTERS</span>, size <span class="op">=</span> <span class="fl">300</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">check</span> <span class="op">&lt;-</span> <span class="fu">early_warning_cluster</span><span class="op">(</span><span class="va">cases</span>,</span></span>
<span class="r-in"><span>                               <span class="va">date</span> <span class="op">&gt;=</span> <span class="st">"2022-01-01"</span>,</span></span>
<span class="r-in"><span>                               threshold_percentile <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using column 'date' for dates</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using column 'patient' for patient IDs</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'check' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">has_clusters</span><span class="op">(</span><span class="va">check</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'check' not found</span>
<span class="r-in"><span><span class="va">check</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'check' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">check2</span> <span class="op">&lt;-</span> <span class="fu">early_warning_cluster</span><span class="op">(</span><span class="va">cases</span>,</span></span>
<span class="r-in"><span>                                <span class="va">date</span> <span class="op">&gt;=</span> <span class="st">"2022-01-01"</span>,</span></span>
<span class="r-in"><span>                                threshold_percentile <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using column 'date' for dates</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using column 'patient' for patient IDs</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">check2</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =&gt; Detected 5 disease clusters with a total of 14 cases based on an outlier-free history (coeff = 1.5) and the 75th pct lasting for &gt;=2 days.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - The 1st cluster has 4 cases between 2 and 8 februari 2022</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - The 2nd cluster has 2 cases between 15 and 17 maart 2022</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - The 3rd cluster has 2 cases between 20 and 22 april 2022</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - The 4th cluster has 4 cases between 7 and 23 mei 2022</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    - The 5th cluster has 2 cases between 23 and 25 december 2022</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use plot2() to plot the results.</span>
<span class="r-in"><span><span class="va">check2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cluster first_day  last_day   ongoing_days total_cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>       1 2022-02-02 2022-02-08            4           4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>       2 2022-03-15 2022-03-17            2           2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>       3 2022-04-20 2022-04-22            2           2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>       4 2022-05-07 2022-05-23            4           4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>       5 2022-12-23 2022-12-25            2           2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">check2</span> <span class="op">|&gt;</span> <span class="fu">n_clusters</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-in"><span><span class="va">check2</span> <span class="op">|&gt;</span> <span class="fu">has_clusters</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">check2</span> <span class="op">|&gt;</span> <span class="fu">has_clusters</span><span class="op">(</span><span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">check2</span> <span class="op">|&gt;</span> <span class="fu">has_ongoing_cluster</span><span class="op">(</span><span class="st">"2022-06-01"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">check</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'check' not found</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Matthijs S. Berends, Erwin Dijkstra, Certe Medical Diagnostics &amp; Advice Foundation.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

